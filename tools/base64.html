<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ¨çº¿ Base64 ç¼–ç /è§£ç å·¥å…· - Datxy</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <nav class="navbar">
        <a href="../index.html" class="logo">Datxy</a>
        <div class="nav-links"><a href="../index.html">è¿”å›é¦–é¡µ</a></div>
    </nav>

    <div class="container">
        <h2>Base64 è½¬æ¢å·¥å…·</h2>
        
        <div class="tool-box">
            <h3 style="margin-bottom: 15px; color: var(--accent-color);">ğŸ…°ï¸ æ–‡æœ¬ â‡Œ Base64</h3>
            <textarea id="textInput" rows="5" placeholder="åœ¨æ­¤è¾“å…¥è¦å¤„ç†çš„æ–‡æœ¬ï¼ˆæ”¯æŒä¸­æ–‡ï¼‰..."></textarea>
            
            <div class="tool-controls">
                <button onclick="textToB64()">â¬‡ï¸ ç¼–ç  (Encode)</button>
                <button class="secondary" onclick="b64ToText()">â¬†ï¸ è§£ç  (Decode)</button>
                <button class="secondary" onclick="document.getElementById('textInput').value=''">ğŸ—‘ï¸ æ¸…ç©ºè¾“å…¥</button>
            </div>

            <textarea id="textOutput" rows="5" placeholder="è½¬æ¢ç»“æœ..." readonly></textarea>
        </div>

        <div class="tool-box">
            <h3 style="margin-bottom: 15px; color: var(--accent-color);">ğŸ–¼ï¸ å›¾ç‰‡ â¡ï¸ Base64</h3>
            <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 10px;">å°†å›¾ç‰‡è½¬æ¢ä¸º DataURI æ ¼å¼ (é€‚åˆ CSS/HTML å†…åµŒå°å›¾æ ‡)</p>
            
            <div style="border: 2px dashed var(--border-color); padding: 20px; text-align: center; border-radius: 8px;">
                <input type="file" id="imgInput" accept="image/*" style="display: none;" onchange="handleImage(this)">
                <button onclick="document.getElementById('imgInput').click()">ğŸ“ é€‰æ‹©å›¾ç‰‡æ–‡ä»¶</button>
                <span id="fileName" style="margin-left: 10px; font-size: 0.9rem; color: var(--text-secondary);"></span>
            </div>

            <textarea id="imgOutput" rows="5" placeholder="data:image/png;base64,..." style="margin-top: 15px;" onclick="this.select()"></textarea>
            
            <div id="imgPreview" style="margin-top: 15px; text-align: center; display: none;">
                <p style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 5px;">é¢„è§ˆï¼š</p>
                <img id="previewObj" style="max-width: 100%; max-height: 200px; border: 1px solid var(--border-color); border-radius: 4px;">
            </div>
        </div>
    </div>

    <script>
        // --- æ–‡æœ¬è½¬æ¢é€»è¾‘ (æ”¯æŒ UTF-8 ä¸­æ–‡) ---
        function textToB64() {
            const input = document.getElementById('textInput').value;
            if(!input) return;
            try {
                // ä½¿ç”¨ encodeURIComponent å¤„ç†ä¸­æ–‡ï¼Œé¿å… btoa æŠ¥é”™
                const b64 = btoa(unescape(encodeURIComponent(input)));
                document.getElementById('textOutput').value = b64;
            } catch (e) {
                alert("ç¼–ç å¤±è´¥ï¼š" + e.message);
            }
        }

        function b64ToText() {
            const input = document.getElementById('textInput').value.trim();
            if(!input) return;
            try {
                // å¯¹åº”ä¸Šé¢çš„è§£ç è¿‡ç¨‹
                const text = decodeURIComponent(escape(atob(input)));
                document.getElementById('textOutput').value = text;
            } catch (e) {
                document.getElementById('textOutput').value = "âŒ æ— æ•ˆçš„ Base64 å­—ç¬¦ä¸²";
            }
        }

        // --- å›¾ç‰‡è½¬æ¢é€»è¾‘ ---
        function handleImage(input) {
            const file = input.files[0];
            if (!file) return;
            
            document.getElementById('fileName').innerText = file.name;

            const reader = new FileReader();
            reader.onload = function(e) {
                const result = e.target.result;
                // è¾“å‡ºä»£ç 
                document.getElementById('imgOutput').value = result;
                // æ˜¾ç¤ºé¢„è§ˆ
                const preview = document.getElementById('previewObj');
                preview.src = result;
                document.getElementById('imgPreview').style.display = 'block';
            };
            reader.readAsDataURL(file);
        }
    </script>
</body>
</html>
